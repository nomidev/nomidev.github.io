<!DOCTYPE html>
<html lang="ko">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1,minimum-scale=1">
	<title>Dbay 공탁금 배당 계산기</title>
	<script src="http://code.jquery.com/jquery-1.11.1.js"></script>
	<script type="text/javascript">
		(function ($, window, undefined) {
			var dbay = {
				deposit: 170000000,
				workTotal: 174386070,
				balance: 2030670,
				nomu: 3000000,
				brother: 4000000,
				trialCost: 150000,
				getDividend: function (value) {
					return Math.floor(this.deposit / this.workTotal * value);
				},
				getNomuLegalFees: function () {
					return this.nomu / this.deposit;
				},
				getBrotherLegalFees: function () {
					return this.brother / this.deposit;
				},
				getBalance: function () {
					return Math.floor(this.balance / 24);
				},
				getTrialCost: function () {
					return this.trialCost - this.getBalance();
				},
				commaNum: function (num) {
					var len, point, str;
		
					num = num + "";
					point = num.length % 3;
					len = num.length;
					str = num.substring(0, point);
		
					while (point < len) {  
						if (str != "") {
							str += ",";
						}
						str += num.substring(point, point + 3);
						point += 3;
					}
					return str;
				},
				init: function () {
					
					$('.workTotal').text(this.commaNum(this.workTotal));
					$('.deposit').text(this.commaNum(this.deposit));
					$('.nomu').text(this.commaNum(this.nomu));
					$('.brother').text(this.commaNum(this.brother));
					$('.balance').text(this.commaNum(this.balance));
		
					$('.myPay').on('keyup', function () {
						
						var that = this;
						
						($.proxy(function () {
							var val = $(that).val(),
								dividend = this.getDividend(val),
								nomusa = Math.floor(dividend * this.getNomuLegalFees()),
								brother = Math.floor(dividend * this.getBrotherLegalFees()),
								receipt = dividend - nomusa - brother,
								legalFee = nomusa + brother,
								resultText = "";
		
							if(val.match(/^\d+$/)) {
								resultText += '<h2>내가 받을 금액은?</h2>';
								resultText += '<h3><strong class="myResult">' + this.commaNum(receipt + this.getBalance()) + '</strong>원 입니다.</h3>';
								resultText += '<p>배당금액: <strong>' + this.commaNum(dividend) + '</strong>원</p>';
								resultText += '<p>노무사 수임료 : <strong>' + this.commaNum(nomusa) + '</strong>원</p>';
								resultText += '<p>법무사 수임료 : <strong>' + this.commaNum(brother) + '</strong>원</p>';
								resultText += '<p>가압류 소송 비용 : <strong>' + this.commaNum(this.getTrialCost()) + '</strong>원</p>';
								resultText += '<p>총 지출 비용 : <strong>' + this.commaNum(nomusa + brother + this.getTrialCost()) + '</strong>원</p>';
								resultText += '<p>실 수령액은 수임료 <strong>' + this.commaNum(legalFee) + '</strong>원을 제외한 <strong>' + this.commaNum(receipt) + '</strong>원과 가압류 진행 비용 환급금 <strong>' + this.commaNum(this.getBalance()) + '</strong>원을 합한</p>';
								resultText += '<h3>총 <strong class="myResult">' + this.commaNum(receipt + this.getBalance()) + '</strong>원 입니다.</h3>';
		
								$('.result').html(resultText);
							} else {
								alert('숫자를 입력해주세요');
								$('.result').html(resultText);
							}
						}, dbay))();
					});
				}
			};
		
			$(document).ready(function () {
				dbay.init();
			});
		
		})(jQuery, window)
	</script>
	<style>
		h1 {font-size: 18px;}
		h2 {font-size: 16px;}
		h3 {font-size: 14px;}
		p {margin-top: 0.5em; margin-bottom: 0.5em; font-size: 12px;}
		p > span {color: #ff6600;}
		h3 > strong.myResult {color: red;}
	</style>
</head>
<body>
	<h1>Dbays 공탁금 배당 계산기</h1>
	<div>
		<p>체불금품확인원에 있는 금액을 넣어주세요</p>
		<input type="number" class="myPay" placeholder="금액을 , 없이 입력해 주세요">
	</div>
	<div>
		<p>① 체불금품확인원 합계 : <strong class="workTotal"></strong>원</p>
		<p>② 공탁금 : <strong class="deposit"></strong>원</p>
		<p>③ 노무사 수임료 : <strong class="nomu"></strong>원</p>
		<p>④ 법무사 수임료 : <strong class="brother"></strong>원</p>
		<p>⑤ 가압류 진행 비용 잔고 : <strong class="balance"></strong>원</p>
		<p>⑥ 배당금 => <span>(② ÷ ①) × 내 체불금품 금액</span></p>
		<p>⑦ 노무사 수임료 => <span>⑥ × (③ ÷ ②)</span></p>
		<p>⑧ 법무사 수임료 => <span>⑥ × (④ ÷ ②)</span></p>
		<p>⑨ 가압류 진행 비용 환급금 => <span>⑤ ÷ 24</span></p>
		<!-- <p><span>*수임료는 확정된 것이 아니라 임의로 산정한 것입니다.</span></p> -->
	</div>
	<div class="result"></div>
</body>
</html>
